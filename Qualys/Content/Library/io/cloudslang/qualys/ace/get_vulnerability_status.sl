########################################################################################################################
#!!
#! @input id_min: (Optional) Show only hosts with a minimum host ID value.
#!!#
########################################################################################################################
namespace: io.cloudslang.qualys.ace
flow:
  name: get_vulnerability_status
  inputs:
    - id_min:
        default: '${id_min}'
        required: false
  workflow:
    - get_host_detection_list:
        do:
          io.cloudslang.qualys.vm.get_host_detection_list:
            - id_min: '${id_min}'
            - truncation_limit: '15'
        publish:
          - return_result
        navigate:
          - FAILURE: on_failure
          - SUCCESS: qualys_vuln_status_xml_to_ace_json
    - qualys_vuln_status_xml_to_ace_json:
        do:
          io.cloudslang.qualys.utils.qualys_vuln_status_xml_to_ace_json:
            - xml_input: '${return_result}'
            - unique_qids: "${get('unique_qid_list', '')}"
        publish:
          - unique_qid_list
          - id_min
        navigate:
          - HAS_MORE: get_host_detection_list
          - SUCCESS: SUCCESS
          - FAILURE: on_failure
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      get_host_detection_list:
        x: 40
        'y': 80
      qualys_vuln_status_xml_to_ace_json:
        x: 360
        'y': 80
        navigate:
          936c8f48-e551-9596-88e8-1bf15f7cc2ca:
            targetId: 6a80c06f-726d-bc97-3dce-9c1bbfba1ef8
            port: SUCCESS
    results:
      SUCCESS:
        6a80c06f-726d-bc97-3dce-9c1bbfba1ef8:
          x: 760
          'y': 80
