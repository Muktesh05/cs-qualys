namespace: io.cloudslang.qualys.ace
flow:
  name: get_vulnerability_status
  workflow:
    - get_host_detection_list:
        do:
          io.cloudslang.qualys.vm.get_host_detection_list:
            - truncation_limit: '15'
        publish:
          - return_result
        navigate:
          - FAILURE: on_failure
          - SUCCESS: qualys_vuln_xml_to_ace_json
    - qualys_vuln_xml_to_ace_json:
        do:
          io.cloudslang.qualys.utils.qualys_vuln_xml_to_ace_json:
            - xml_input: '${return_result}'
            - unique_qids: '${unique_qid_list}'
        publish:
          - unique_qid_list
        navigate:
          - HAS_MORE: SUCCESS
          - SUCCESS: SUCCESS
  results:
    - FAILURE
    - SUCCESS
extensions:
  graph:
    steps:
      get_host_detection_list:
        x: 40
        'y': 80
      qualys_vuln_xml_to_ace_json:
        x: 360
        'y': 80
        navigate:
          36c26dde-7492-8dcf-ba39-4c5b111f37e3:
            targetId: 6a80c06f-726d-bc97-3dce-9c1bbfba1ef8
            port: SUCCESS
          942a8849-80e9-36e5-e908-814a4b774184:
            targetId: 6a80c06f-726d-bc97-3dce-9c1bbfba1ef8
            port: HAS_MORE
    results:
      SUCCESS:
        6a80c06f-726d-bc97-3dce-9c1bbfba1ef8:
          x: 760
          'y': 80
